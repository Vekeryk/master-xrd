–Ø –ø—Ä–∞—Ü—é—é –Ω–∞–¥ –º–∞–≥—ñ—Å—Ç–µ—Ä—Å—å–∫–æ—é —Ä–æ–±–æ—Ç–æ—é.
–¶–µ –º—ñ–∂–¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞—Ä–Ω–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –≤ –º–µ–∂–∞—Ö —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ—Å—Ç–µ–π –Ü–Ω–∂–µ–Ω–µ—Ä—ñ—è –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ç–∞ –§—ñ–∑–∏–∫–∞ —Ç–∞ –∞—Å—Ç—Ä–æ–Ω–æ–º—ñ—è.

–¢–µ–º–∞: **–û—Ü—ñ–Ω–∫–∞ —è–∫–æ—Å—Ç—ñ —Ç–∞ —Ç–æ—á–Ω–æ—Å—Ç—ñ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É X-–ø—Ä–æ–º–µ–Ω–µ–≤–∏—Ö –∫—Ä–∏–≤–∏—Ö –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–æ–≥–æ –≤—ñ–¥–±–∏–≤–∞–Ω–Ω—è (XRD)**

–ú–µ—Ç–∞: –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏–π –ø—ñ–¥–±—ñ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–Ω–æ–∫—Ä–∏—Å—Ç–∞–ª—ñ—á–Ω–∏—Ö –∑—Ä–∞–∑–∫—ñ–≤, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –º—ñ–∂ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ—é —Ç–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ—é –ö–î–í (–∫—Ä–∏–≤–æ—é –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–æ–≥–æ –≤—ñ–¥–±–∏–≤–∞–Ω–Ω—è).
–ú–µ—Ç–æ—é –¥–∞–Ω–æ–≥–æ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è —î —Ä–æ–∑—Ä–æ–±–∫–∞ –º–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—ó –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –∑–≥–æ—Ä—Ç–∫–æ–≤–∏—Ö –Ω–µ–π—Ä–æ–Ω–Ω–∏—Ö –º–µ—Ä–µ–∂ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É X-–ø—Ä–æ–º–µ–Ω–µ–≤–∏—Ö –∫—Ä–∏–≤–∏—Ö –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–æ–≥–æ –≤—ñ–¥–±–∏–≤–∞–Ω–Ω—è —Ç–∞ –æ—Ü—ñ–Ω–∫–∞ —ó—Ö –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–æ–Ω–æ–∫—Ä–∏—Å—Ç–∞–ª—ñ—á–Ω–∏—Ö –∑—Ä–∞–∑–∫—ñ–≤ –∑ –¥–µ—Ñ–µ–∫—Ç–Ω–∏–º–∏ –ø—Ä–∏–ø–æ–≤–µ—Ä—Ö–Ω–µ–≤–∏–º–∏ —à–∞—Ä–∞–º–∏.

–û—Å–Ω–æ–≤–æ—é –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è —î —Ä–æ–∑—Ä–æ–±–∫–∞ —Å–∏—Å—Ç–µ–º–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω–∏—Ö –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö, —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å –∑–≤'—è–∑–æ–∫ –º—ñ–∂ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ –¥–µ—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º–∏ –ö–î–í. –î–ª—è —Ü—å–æ–≥–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤–∞—Ä—ñ—é–≤–∞–Ω–Ω—è –∫–ª—é—á–æ–≤–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —É –∑–∞–¥–∞–Ω–∏—Ö –º–µ–∂–∞—Ö:

¬∑¬†¬†¬†¬†¬†¬† Dmax1: 0.001 ‚Äì 0.030 (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –¥–µ—Ñ–æ—Ä–º–∞—Ü—ñ—è –≤ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ–π –≥–∞—É—Å—ñ–∞–Ω—ñ);
¬∑¬†¬†¬†¬†¬†¬† D01: 0.002 ‚Äì Dmax1 (–¥–µ—Ñ–æ—Ä–º–∞—Ü—ñ—è –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω—ñ –≤ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ–π –≥–∞—É—Å—ñ–∞–Ω—ñ);
¬∑¬†¬†¬†¬†¬†¬† L1: 1000 ‚Äì 7000 √Ö (—Ç–æ–≤—â–∏–Ω–∞ –ø–æ—Ä—É—à–µ–Ω–æ–≥–æ —à–∞—Ä—É –≤ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ–π –≥–∞—É—Å—ñ–∞–Ω—ñ);
¬∑¬†¬†¬†¬†¬†¬† Rp1: 0 ‚Äì L1 (–ø–æ–ª–æ–∂–µ–Ω–Ω—è –º–∞–∫—Å–∏–º—É–º—É –¥–µ—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ–π –≥–∞—É—Å—ñ–∞–Ω—ñ);
¬∑¬†¬†¬†¬†¬†¬† D02: 0.002 ‚Äì 0.030 (–¥–µ—Ñ–æ—Ä–º–∞—Ü—ñ—è –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω—ñ –≤ —Å–ø–∞–¥–Ω—ñ–π –≥–∞—É—Å—ñ–∞–Ω—ñ);
¬∑¬†¬†¬†¬†¬†¬† L2: 1000 ‚Äì 7000 √Ö (—Ç–æ–≤—â–∏–Ω–∞ –ø–æ—Ä—É—à–µ–Ω–æ–≥–æ —à–∞—Ä—É –≤ —Å–ø–∞–¥–Ω—ñ–π –≥–∞—É—Å—ñ–∞–Ω—ñ);
¬∑¬†¬†¬†¬†¬†¬† Rp2: ‚Äì6000 ‚Äì 0 √Ö (–ø–æ–ª–æ–∂–µ–Ω–Ω—è –º–∞–∫—Å–∏–º—É–º—É –¥–µ—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ —Å–ø–∞–¥–Ω—ñ–π –≥–∞—É—Å—ñ–∞–Ω—ñ);
¬∑¬†¬†¬†¬†¬†¬† dl: 20 √Ö (—Ç–æ–≤—â–∏–Ω–∞ –ø—ñ–¥—à–∞—Ä—ñ–≤, –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞);
¬∑¬†¬†¬†¬†¬†¬† Dmin: 0.0001 (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –¥–µ—Ñ–æ—Ä–º–∞—Ü—ñ—è, –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞).

–î–æ—Å–ª—ñ–¥–∂—É—î—Ç—å—Å—è –ø—Ä–∏–ø–æ–≤–µ—Ä—Ö–Ω–µ–≤–∞ –æ–±–ª–∞—Å—Ç—å –∑ –¥–µ—Ñ–µ–∫—Ç–∞–º–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —É –Ω–∞—Å–ª—ñ–¥–æ–∫ —ñ–æ–Ω–Ω–æ—ó —ñ–º–ø–ª–∞–Ω—Ç–∞—Ü—ñ—ó.

–û–±–æ–≤—è–∑–∫–æ–≤–∏–π —Ñ–æ–∫—É—Å:

1. –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ç–æ–Ω–∫–∏—Ö –ø–ª—ñ–≤–æ–∫ (—Ç–æ–≤—â–∏–Ω–∞ —à–∞—Ä—É, —à–æ—Ä—Å—Ç–∫—ñ—Å—Ç—å –º–µ–∂—ñ, –≥—É—Å—Ç–∏–Ω–∞ —Ç–æ—â–æ) –∑ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∏—Ö –∫—Ä–∏–≤–∏—Ö –¥–∏—Ñ—Ä–∞–∫—Ü—ñ—ó (XRD). (–¶–µ —Ç–µ —â–æ –º–∏ —Ä–æ–±–∏–º–æ)
2. –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ –¥–∞–Ω–∏—Ö –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É. –û–∫—Ä–µ–º–æ –≤–∞—Ä—Ç–æ –∑–≥–∞–¥–∞—Ç–∏ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –Ω–µ–π—Ä–æ–Ω–Ω–∏—Ö –º–µ—Ä–µ–∂ –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ XRD-–∫—Ä–∏–≤–∏—Ö, —â–æ –æ–ø–æ—Å–µ—Ä–µ–¥–∫–æ–≤–∞–Ω–æ –¥–æ–ø–æ–º–∞–≥–∞—î —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–º—É —Ä–æ–∑–≤‚Äô—è–∑–∞–Ω–Ω—é. (–¢–∞–∫–∏–π –ø—ñ–¥—Ö—ñ–¥ –Ω–∞—Å —Ç–µ–∂ —Ü—ñ–∫–∞–≤–∏—Ç—å)

–ù–∞—É–∫–æ–≤–∞ –Ω–æ–≤–∏–∑–Ω–∞ —Ä–æ–±–æ—Ç–∏ –ø–æ–ª—è–≥–∞—î –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ—ó –º–æ–¥–µ–ª—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–∞—à–∏–Ω–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ–≥–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –∑ X-–ø—Ä–æ–º–µ–Ω–µ–≤–∏—Ö –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–∏—Ö –∫—Ä–∏–≤–∏—Ö —Ç–∞ —ó—ó —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –≤ —ñ—Å–Ω—É—é—á–µ –ø—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –≥—ñ–±—Ä–∏–¥–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–∞–∑–æ–º —ñ–∑ —Ñ—ñ–∑–∏—á–Ω–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏.

–¶–µ **–Ω–µ XRR —É –∫–ª–∞—Å–∏—á–Ω–æ–º—É —Å–µ–Ω—Å—ñ**, –∞ —Å–∞–º–µ **HRXRD rocking curves (–¥–≤–æ–∫—Ä–∏—Å—Ç–∞–ª—å–Ω–∞ –¥–∏—Ñ—Ä–∞–∫—Ç–æ–º–µ—Ç—Ä—ñ—è)**.  
–¢–æ–±—Ç–æ —Ç–∏ –ø—Ä–∞—Ü—é—î—à –≤ –ø–æ–ª—ñ **XRD**, –∞–ª–µ –∑ –≤—É–∑—å–∫–∏–º –ø—ñ–¥–º–µ—Ç–æ–¥–æ–º ‚Äî –∞–Ω–∞–ª—ñ–∑–æ–º **–∫—Ä–∏–≤–∏—Ö –≤—ñ–¥–±–∏–≤–∞–Ω–Ω—è –º–æ–Ω–æ–∫—Ä–∏—Å—Ç–∞–ª—ñ–≤ (rocking curves)**.
–£ –¥–∞–Ω—ñ–π —Ä–æ–±–æ—Ç—ñ –ø—ñ–¥ X-–ø—Ä–æ–º–µ–Ω–µ–≤–∏–º–∏ –∫—Ä–∏–≤–∏–º–∏ –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–æ–≥–æ –≤—ñ–¥–±–∏–≤–∞–Ω–Ω—è –º–∞—é—Ç—å—Å—è –Ω–∞ —É–≤–∞–∑—ñ rocking curves, –æ—Ç—Ä–∏–º–∞–Ω—ñ –º–µ—Ç–æ–¥–æ–º –≤–∏—Å–æ–∫–æ—Ä–æ–∑–¥—ñ–ª—å–Ω–æ—ó —Ä–µ–Ω—Ç–≥–µ–Ω—ñ–≤—Å—å–∫–æ—ó –¥–∏—Ñ—Ä–∞–∫—Ç–æ–º–µ—Ç—Ä—ñ—ó (HRXRD, double-crystal diffractometry), —â–æ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ X-ray reflectivity (XRR) —ñ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ–≥–æ powder XRD.

–ú–æ—è —Ä–æ–±–æ—Ç–∞ –∑–æ—Å–µ—Ä–µ–¥–∂–µ–Ω–∞ –Ω–∞ **–∞–Ω–∞–ª—ñ–∑—ñ –¥–≤–æ–∫—Ä–∏—Å—Ç–∞–ª—å–Ω–∏—Ö –∫—Ä–∏–≤–∏—Ö –¥–∏—Ñ—Ä–∞–∫—Ü—ñ–π–Ω–æ–≥–æ –≤—ñ–¥–±–∏–≤–∞–Ω–Ω—è (HRXRD rocking curves)** –≤—ñ–¥ –ø—Ä–∏–ø–æ–≤–µ—Ä—Ö–Ω–µ–≤–∏—Ö —à–∞—Ä—ñ–≤ –º–æ–Ω–æ–∫—Ä–∏—Å—Ç–∞–ª—ñ–≤ –∑ –¥–µ—Ñ–µ–∫—Ç–∞–º–∏. –í–∏ –ø—Ä–∞–≥–Ω–µ—Ç–µ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ –ø—ñ–¥–±–∏—Ä–∞—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏**, —Ç–∞–∫—ñ —è–∫ —Ç–æ–≤—â–∏–Ω–∞ —à–∞—Ä—É, —à–æ—Ä—Å—Ç–∫—ñ—Å—Ç—å –º–µ–∂—ñ, –≥—É—Å—Ç–∏–Ω–∞, **–ø—Ä–æ—Ñ—ñ–ª—ñ –¥–µ—Ñ–æ—Ä–º–∞—Ü—ñ—ó** —Ç–∞ –¥–µ—Ñ–µ–∫—Ç–∏, –≤—Ä–∞—Ö–æ–≤—É—é—á–∏ —è–∫ –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω—É, —Ç–∞–∫ —ñ –¥–∏—Ñ—É–∑–Ω—É —Å–∫–ª–∞–¥–æ–≤—ñ —Ä–µ–Ω—Ç–≥–µ–Ω—ñ–≤—Å—å–∫–æ–≥–æ —Ä–æ–∑—Å—ñ—è–Ω–Ω—è

---

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ —Ç–∞ –≤–∞–∂–ª–∏–≤—ñ –∑–Ω–∞–Ω–Ω—è

### ML Model Architecture (v3 - Ziegler-Inspired)

- **–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞:** 1D CNN –∑ residual blocks
- **Kernel size:** K=15 (–∑–∞ Ziegler et al.)
- **–ö–∞–Ω–∞–ª–∏:** Progressive expansion 32‚Üí48‚Üí64‚Üí96‚Üí128‚Üí128
- **Residual blocks:** 6 –±–ª–æ–∫—ñ–≤ –∑ dilation 1,2,4,8,16,32
- **Pooling:** Attention-based pooling (–∑–∞–º—ñ—Å—Ç—å GAP)
- **MLP head:** 128‚Üí256‚Üí128‚Üí7 –∑ Dropout(0.2)
- **Output:** 7 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ [Dmax1, D01, L1, Rp1, D02, L2, Rp2]

### ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û –í–ê–ñ–õ–ò–í–û: model.eval()

**–ó–ê–í–ñ–î–ò –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `model.eval()` –ø–µ—Ä–µ–¥ inference!**

### Dataset Generation

**–ü–æ—Ç–æ—á–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:** 7D stratified sampling (dataset_stratified_7d.py)

**–§—ñ–∑–∏—á–Ω—ñ constraints (nested):**

1. `D01 <= Dmax1`
2. `D01 + D02 <= 0.03`
3. `Rp1 <= L1`
4. `L2 <= L1`

**–°—Ç–∞—Ç—É—Å uniform distribution:**

- Chi-square test: –≤—Å—ñ 7 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ **non-uniform** (p < 0.05)
- Imbalance: 4.26x ratio (min 249, max 1061 counts)
- –ü—Ä–∏—á–∏–Ω–∞: nested constraints —Å—Ç–≤–æ—Ä—é—é—Ç—å bins —Ä—ñ–∑–Ω–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É
- ‚úÖ –ü—Ä–∏–π–Ω—è—Ç–Ω–æ: –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –≤—ñ–¥ >100x –¥–æ 4.26x

**–î–∞—Ç–∞—Å–µ—Ç–∏:**

- `dataset_10000_dl100_7d.pkl` - 10k samples –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- `dataset_100000_dl100_7d.pkl` - 100k samples –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

### Training Configuration

**–§–∞–π–ª:** `model_train.py` (unified script)

**–ü—Ä–∞–ø–æ—Ä—Ü—ñ:**

```python
WEIGHTED_TRAINING = True/False    # Weighted vs unweighted loss
FULL_CURVE_TRAINING = True/False  # Full curve vs cropped [50:701]
```

**Loss weights (—è–∫—â–æ WEIGHTED_TRAINING=True):**

```python
LOSS_WEIGHTS = torch.tensor([1.0, 1.2, 1.0, 1.0, 1.5, 2.0, 2.5])
# Order: [Dmax1, D01, L1, Rp1, D02, L2, Rp2]
```

**–ù–∞–∑–≤–∏ –º–æ–¥–µ–ª–µ–π (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ):**

- Weighted + Cropped: `dataset_100000_dl100_7d_v3.pt`
- Weighted + Full: `dataset_100000_dl100_7d_v3_full.pt`
- Unweighted + Cropped: `dataset_100000_dl100_7d_v3_unweighted.pt`
- Unweighted + Full: `dataset_100000_dl100_7d_v3_unweighted_full.pt`

**Preprocessing –º–∞—î —Å–ø—ñ–≤–ø–∞–¥–∞—Ç–∏ –º—ñ–∂ training —ñ inference!**

1. **Crop params:**

   - Training: `load_dataset(path, use_full_curve=False)` ‚Üí Y[:, 50:701] (651 points)
   - Inference: **MUST USE SAME** cropping –∞–±–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ `use_full_curve=True`

2. **Log-space transform:**
   - `NormalizedXRDDataset(X, Y, log_space=True, train=False)`
   - **CRITICAL:** `log_space=True` –¥–ª—è –º–æ–¥–µ–ª—ñ v3 (–Ω–∞–≤—á–∞–ª–∞—Å—è –∑ log-space)

### Model Performance (–Ω–∞ 10k dataset)

**v3 Results (10k samples, 100 epochs):**

- Final train loss: 0.0126
- Final val loss: 0.0191
- **Best val loss: 0.0191 –Ω–∞ epoch 47**
- Overfitting gap: ~50% (acceptable)

**v2 Baseline (100k samples):**

- Val loss: 0.0130
- Rp2 error: 12.36%
- L2 error: 5.86%

**–í–∏—Å–Ω–æ–≤–∫–∏:**

- v3 –Ω–∞ 10k –≥—ñ—Ä—à–∏–π –∑–∞ v2 –Ω–∞ 100k (0.0191 vs 0.0130)
- Best epoch: 47/100 ‚Üí –ø—ñ—Å–ª—è —Ü—å–æ–≥–æ —Å—Ç–∞–≥–Ω–∞—Ü—ñ—è
- –ü–æ—Ç—Ä—ñ–±–Ω–æ –±—ñ–ª—å—à–µ –¥–∞–Ω–∏—Ö (100k) –∞–±–æ early stopping

### Common Bugs & Fixes

#### Bug 3: Dataset Uniformity

**–ü—Ä–æ–±–ª–µ–º–∞:** Chi-square test –ø–æ–∫–∞–∑—É—î non-uniform distribution –ø—ñ—Å–ª—è 7D sampling.

**–ü—Ä–∏—á–∏–Ω–∞:** Nested constraints —Å—Ç–≤–æ—Ä—é—é—Ç—å bins —Ä—ñ–∑–Ω–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É.

**Status:** –ü—Ä–∏–π–Ω—è—Ç–Ω–æ - imbalance 4.26x –∫—Ä–∞—â–µ –∑–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ >100x.

### Files Overview

**Training:**

- `model_train.py` - unified training script (weighted/unweighted, full/cropped)
- `model_common.py` - model architecture, dataset, utilities

**Dataset Generation:**

- `dataset_stratified_7d.py` - 7D stratified sampling with physical constraints
- `xrd.py` - XRD curve generation (physics)

**Evaluation:**

- `model_evaluate.py` - evaluate model on dataset, show MAE metrics
- `j_show_experiment.ipynb` - visualize predictions vs true curves
- `j_analyze_dataset.ipynb` - dataset quality analysis

**Documentation and Claude tests:**

Create md file in contect/ directory and test files in tests/ directory
