# Процес навчання моделі та метрики якості

## 4.3.4 Процес навчання моделі

Навчання нейромережевої моделі здійснювалося на синтетичному датасеті, що містить 100 000 пар параметрів профілю деформації та відповідних КДВ. Дані були розділені на навчальну та валідаційну вибірки у співвідношенні 80:20, що забезпечило надійну оцінку узагальнювальної здатності моделі.

Для оптимізації використовувався алгоритм Adam з початковою швидкістю навчання 0.001 та регуляризацією ваг (weight decay) 0.0001. Розмір міні-пакету (batch size) для навчальної вибірки становив 32 зразки, що забезпечило баланс між стабільністю градієнтів та ефективністю використання пам'яті GPU. Для валідаційної вибірки при обчисленні помилки реконструкції КДВ використовувався менший розмір пакету (4 зразки) через значні обчислювальні витрати на генерацію теоретичних кривих за допомогою фізичної моделі.

Важливою особливістю процесу навчання є використання двох незалежних метрик якості на валідаційній вибірці. Перша метрика (val_params) обчислює середню абсолютну помилку (MAE, Mean Absolute Error) безпосередньо між передбаченими та істинними значеннями параметрів профілю. Друга метрика (val_CURVE) оцінює якість передбачення через порівняння КДВ: для кожного набору передбачених параметрів генерується теоретична крива з використанням тієї ж фізичної моделі, що застосовувалась для створення датасету, після чого обчислюється MAE між згенерованою та цільовою кривими. Саме ця друга метрика була обрана як критерій раннього зупинення (early stopping), оскільки вона безпосередньо відображає фізичну адекватність передбачень та їх придатність для практичного застосування.

Динаміка процесу навчання продемонстрована на рисунку [номер]. Графік (а) відображає зміну функції втрат на навчальній та валідаційній вибірках по параметрах. Спостерігається швидке зниження помилки на перших епохах навчання: з початкового значення 0.01029 до 0.00058 на епосі 11, що становить покращення на 94.4%. Близькість кривих навчальної та валідаційної вибірок свідчить про відсутність суттєвого перенавчання (overfitting), що підтверджує ефективність застосованих методів регуляризації.

Графік (б) демонструє динаміку помилки реконструкції КДВ на валідаційній вибірці. Початкове значення помилки 0.24297 знижується до мінімального значення 0.05538 на епосі 18, що відповідає покращенню на 77.2%. Характерні флуктуації цієї метрики пов'язані з чутливістю фізичної моделі до малих змін параметрів: навіть незначна зміна у передбаченнях може суттєво вплинути на форму теоретичної КДВ. Досягнення мінімуму на епосі 18 та подальша стабілізація значень вказують на те, що модель навчилася знаходити баланс між точністю передбачення окремих параметрів та фізичною коректністю відповідних деформаційних профілів.

**Рисунок [номер].** Динаміка процесу навчання нейромережевої моделі: а) зміна функції втрат на навчальній (синій) та валідаційній (оранжевий) вибірках по параметрах; б) динаміка помилки реконструкції КДВ на валідаційній вибірці (зелений). Зірочками позначено епохи з мінімальними значеннями відповідних метрик.

## 4.4 Оцінка якості та валідація моделі

### 4.4.1 Метрики оцінювання

Після завершення навчання було проведено детальну оцінку якості моделі на повному валідаційному наборі даних, що містить 100 000 зразків. Для кожного з семи параметрів профілю деформації обчислювались наступні метрики:

**Середня абсолютна помилка (MAE)** – основна метрика, що показує середнє відхилення передбачень від істинних значень в абсолютних одиницях. Ця метрика є стійкою до викидів та має пряму фізичну інтерпретацію.

**Середньоквадратична помилка (RMSE)** – метрика, що надає більшу вагу значним відхиленням порівняно з MAE. Оцінка RMSE була отримана з урахуванням типового співвідношення RMSE ≈ 1.25×MAE для розподілів помилок, близьких до нормального.

**Відносна помилка у відсотках від діапазону** – нормалізована метрика, що виражає MAE як відсоток від повного діапазону можливих значень параметра. Ця метрика дозволяє порівнювати точність передбачення різних параметрів незалежно від їх абсолютних значень.

**Відносна помилка у відсотках від середнього значення** – метрика, що виражає MAE відносно середнього значення параметра у валідаційній вибірці. Ця характеристика особливо важлива для оцінки практичної значущості помилок.

Результати оцінки якості моделі представлені у таблиці 4.1. Аналіз метрик демонструє високу точність передбачення більшості параметрів. Найкращі результати отримані для параметрів Rp1 та L1, що характеризують положення максимуму та товщину деформованого шару в асиметричній гаусіані: відносна помилка становить лише 2.00-2.02% від діапазону значень. Це пояснюється тим, що ці параметри мають найбільш виражений вплив на форму основних особливостей КДВ.

Параметри Dmax1, D01 та D02, що визначають амплітуду деформації, також передбачаються з високою точністю: відносна помилка не перевищує 4.85% від діапазону. Варто відзначити, що відносна помилка у відсотках від середнього значення для цих параметрів є дещо вищою (до 15.53% для D01), що пов'язано з тим, що ці параметри можуть набувати малих значень, близьких до нижньої межі діапазону.

Параметр L2 (товщина шару в спадній гаусіані) характеризується помилкою 6.31% від діапазону. Дещо гірша точність порівняно з L1 обумовлена меншим впливом цього параметра на загальну форму КДВ у випадках, коли домінуючий внесок дає асиметрична складова профілю деформації.

Найбільша відносна помилка спостерігається для параметра Rp2 (положення максимуму в спадній гаусіані) – 14.98% від діапазону. Це є очікуваним результатом, оскільки даний параметр має найменш визначений вплив на КДВ, особливо коли амплітуда спадної компоненти є малою. Тим не менш, абсолютна помилка для цього параметра залишається на прийнятному рівні (9.74×10⁻⁶ Å).

Колірне виділення у таблиці підкреслює параметр Rp1 (зелений) як такий, що передбачається з найвищою відносною точністю, та параметр Rp2 (червоний) як найбільш складний для точного визначення. Ця інформація є важливою для розуміння обмежень методу та інтерпретації результатів при аналізі реальних експериментальних даних.

Загалом, отримані метрики свідчать про високу якість навченої моделі та її придатність для автоматизованого визначення стартових значень параметрів профілю деформації з експериментальних КДВ.

---

## Альтернативний варіант для розділу 3 (ПРОЕКТУВАННЯ)

Якщо опис процесу навчання потрібен у розділі 3:

## 3.4 Проектування процесу передбачення та уточнення параметрів

Процес використання нейромережевої моделі для визначення параметрів профілю деформації передбачає декілька послідовних етапів, кожен з яких має бути ретельно спроектований для забезпечення надійності та точності результатів.

**Етап навчання моделі.** На цьому етапі модель оптимізується на великому синтетичному датасеті з використанням методів стохастичної оптимізації. Критично важливим є використання двох незалежних метрик якості: прямої помилки на параметрах (що забезпечує швидку збіжність) та помилки реконструкції КДВ через фізичну модель (що гарантує фізичну адекватність передбачень). Система раннього зупинення має базуватися саме на другій метриці, оскільки вона безпосередньо відображає придатність результатів для практичного застосування.

**Етап валідації.** Передбачається регулярна оцінка якості моделі на незалежній валідаційній вибірці з обчисленням набору метрик для кожного параметра. Важливо врахувати, що різні параметри профілю мають різний ступінь впливу на форму КДВ, тому очікувані рівні точності їх визначення будуть відрізнятися. Система оцінювання має включати як абсолютні метрики (MAE, RMSE), так і відносні (відсотки від діапазону та середнього значення), що дозволить об'єктивно порівнювати якість передбачення різнорідних параметрів.

**Етап застосування до експериментальних даних.** При використанні моделі для аналізу реальних КДВ необхідно забезпечити ідентичну попередню обробку вхідних даних (нормалізацію довжини, виключення піку підкладки, приведення до логарифмічного простору). Результатом роботи моделі є стартовий набір параметрів, який може безпосередньо використовуватись фізиком або передаватись на подальше уточнення традиційними методами оптимізації.

**Етап уточнення параметрів.** Оскільки нейромережева модель забезпечує швидке визначення наближених значень параметрів, доцільно передбачити можливість їх подальшого уточнення з використанням локальної оптимізації. Стартові значення від моделі, будучи близькими до оптимальних, дозволяють уникнути проблеми локальних мінімумів та суттєво прискорити збіжність традиційних методів підбору.
