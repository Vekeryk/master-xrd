# Нормалізація та попередня обробка експериментальних і синтетичних КДВ

## 4.2.4 Нормалізація експериментальних та синтетичних даних

Однією з ключових проблем при створенні системи машинного навчання для аналізу КДВ є забезпечення уніфікованої структури вхідних даних. Експериментальні криві, отримані в процесі рентгенівської дифрактометрії, мають низку особливостей, які ускладнюють їх безпосереднє використання для навчання нейромережевої моделі.

Основна проблема полягає в тому, що експериментальні КДВ можуть мати різну кількість точок від початку вимірювання до піку дифракції від підкладки. Це пов'язано з особливостями роботи дифрактометричного обладнання та параметрами зйомки, які можуть варіюватися залежно від конкретного експерименту. При цьому інтенсивний пік від підкладки не містить інформації про деформації у приповерхневому шарі, оскільки відображає дифракцію від недеформованої частини кристалу. Більше того, присутність піка з високими значеннями інтенсивності (зазвичай на кілька порядків більшими за інтенсивності від деформованого шару) негативно впливає на процес навчання моделі, створюючи значний дисбаланс у діапазоні вхідних значень.

Для вирішення цієї проблеми було розроблено методику автоматизованої обробки КДВ, яка полягає у виявленні позиції максимуму інтенсивності та відкиданні ділянки кривої, що включає пік підкладки. Алгоритм визначає точку максимальної інтенсивності та обирає початком аналізованої ділянки точку, зміщену на фіксовану кількість кроків після піку (зазвичай 30 точок). Це дозволяє гарантовано пропустити область піку та зосередитися на ділянці кривої, що містить інформацію про деформаційні профілі приповерхневого шару.

Другою важливою проблемою є варіативність довжини експериментальних КДВ. Залежно від максимальної деформації у зразку та параметрів дифракційного експерименту, криві можуть містити різну кількість точок. Для забезпечення однорідності вхідних даних необхідно привести всі криві до єдиної довжини. На основі аналізу наявних експериментальних зразків було визначено, що більшість КДВ не перевищує 700 точок після відкидання ділянки з піком підкладки, тому саме це значення було обрано як стандартна довжина для моделі машинного навчання.

Процедура приведення кривих до цільової довжини включає два можливі сценарії. У випадку, коли експериментальна крива є коротшою за цільову довжину, виконується доповнення (padding) недостатньої ділянки значеннями, що відповідають рівню шуму детектора. Це фізично обґрунтовано, оскільки за межами інформативної частини КДВ дифрактометр реєструє лише фоновий шум. Для забезпечення реалістичності доповнених ділянок на них накладається експоненціальний шум з відносною амплітудою близько 2%, що відповідає типовим флуктуаціям експериментальних даних.

У випадку синтетичних КДВ, згенерованих за допомогою фізичної моделі, також застосовується процедура додавання шуму для наближення до реальних експериментальних умов. Важливою особливістю є обробка хвостової частини кривої, де теоретична інтенсивність може опускатися нижче мінімального рівня, який здатен зареєструвати реальний детектор. У таких випадках виконується обмеження інтенсивності до порогового значення шуму з застосуванням гладкого переходу для уникнення різких стрибків. Така обробка дозволяє зменшити розбіжність між синтетичними та експериментальними даними (sim-to-real gap, розбіжність синтетика-реальність), що є критичним фактором для успішного застосування навченої моделі до реальних вимірювань.

Застосування описаної методології попередньої обробки до всіх КДВ – як синтетичних у процесі формування навчального набору даних, так і експериментальних під час інференсу (inference, застосування моделі) – забезпечує єдиний формат вхідних даних та підвищує якість передбачень нейромережевої моделі. На рисунку [номер] продемонстровано приклад застосування процедури попередньої обробки до експериментальної КДВ, де чітко видно виключення піку підкладки та нормалізацію довжини кривої до стандартної величини.

**Рисунок [номер].** Приклад попередньої обробки експериментальної КДВ: а) оригінальна експериментальна крива з позначенням піку підкладки та початку аналізованої ділянки; б) результат після застосування процедури попередньої обробки з нормалізацією до 700 точок та обробкою хвостової частини.

---

## Альтернативний варіант для розділу 3 (ПРОЕКТУВАННЯ)

Якщо цей матеріал має бути у розділі 3, де ще немає конкретного коду, текст можна переформулювати більш абстрактно:

## 3.2.1 Принципи нормалізації вхідних даних

При проектуванні системи машинного навчання для аналізу КДВ необхідно врахувати особливості експериментальних даних та забезпечити їх уніфікацію для ефективного навчання моделі.

Експериментальні КДВ характеризуються наступними особливостями, які потребують врахування на етапі проектування:

**Варіативність початкової ділянки.** Кількість точок від початку вимірювання до піку дифракції від підкладки може суттєво відрізнятися між різними експериментами. Оскільки інтенсивний пік підкладки не містить інформації про деформаційні профілі приповерхневого шару та може негативно впливати на навчання моделі через значний дисбаланс інтенсивностей, необхідно передбачити механізм його виключення з аналізованих даних.

**Різна довжина кривих.** Залежно від ступеня деформації у зразку та параметрів експерименту, КДВ можуть мати різну протяжність. Для забезпечення сумісності з архітектурою нейронної мережі, яка потребує фіксованого розміру вхідних даних, необхідно розробити методологію приведення кривих до єдиної довжини.

**Рівень експериментального шуму.** Реальні вимірювання містять статистичні флуктуації, обумовлені природою детектування рентгенівського випромінювання. Синтетичні дані, згенеровані фізичною моделлю, мають бути доповнені відповідним шумом для зменшення розбіжності з експериментальними умовами.

Для вирішення цих проблем проектується система попередньої обробки, що включає наступні компоненти:

1. **Модуль виявлення та виключення піку підкладки.** Передбачається автоматичне визначення позиції максимуму інтенсивності та формування вхідного вектора, починаючи з точки, розташованої на фіксовану відстань після піку.

2. **Модуль нормалізації довжини.** На основі аналізу типових експериментальних даних визначається цільова довжина вхідного вектора. Система має забезпечувати як доповнення коротших кривих до цільової довжини, так і обрізання надто довгих кривих.

3. **Модуль емуляції експериментального шуму.** Для синтетичних даних передбачається додавання шуму, що імітує статистичні флуктуації реального дифрактометра. Особливу увагу приділяється обробці хвостової частини кривої, де інтенсивність наближається до порогу чутливості детектора.

Критично важливим принципом проектування є забезпечення ідентичної обробки як синтетичних даних на етапі формування навчального набору, так і експериментальних даних на етапі застосування моделі. Це дозволяє мінімізувати систематичні відмінності між навчальним та робочим режимами використання системи.
