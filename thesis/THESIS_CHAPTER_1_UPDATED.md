# РОЗДІЛ 1. АНАЛІЗ СУЧАСНИХ МЕТОДІВ РЕНТГЕНОСТРУКТУРНОГО АНАЛІЗУ ТА ЗАСТОСУВАННЯ МАШИННОГО НАВЧАННЯ У МАТЕРІАЛОЗНАВСТВІ

## 1.1. Методи рентгеноструктурного аналізу монокристалів

### 1.1.1. Фізичні основи дифракції рентгенівських променів

Рентгеноструктурний аналіз є одним з найпотужніших методів дослідження атомної структури кристалічних матеріалів. Фізична основа методу полягає у взаємодії рентгенівських променів з періодичною структурою кристалічної решітки, що призводить до явища дифракції [1].

Умова Брегга-Вульфа, сформульована у 1913 році, визначає кути, під якими спостерігається конструктивна інтерференція відбитих променів:

```
2d·sin(θ) = nλ
```

де d — міжплощинна відстань, θ — кут падіння (кут Брегга), λ — довжина хвилі рентгенівського випромінювання, n — порядок відбиття [2].

**Історичний розвиток методів аналізу**:

1. **Кінематична теорія дифракції** (Laue, 1912; Bragg, 1913) [3]:
   - Застосовна до недосконалих кристалів, порошків
   - Припущення: первинний промінь не ослаблюється при проходженні через кристал
   - Не враховує багаторазову дифракцію
   - Інтенсивність пропорційна квадрату структурного фактора: I ∝ |F(hkl)|²

2. **Динамічна теорія дифракції** (Darwin, 1914; Ewald, 1917) [4, 5]:
   - Розроблена для досконалих монокристалів
   - Враховує багаторазове розсіяння променів у кристалі
   - Описує зв'язок між падаючою та дифрагованою хвилями
   - Точно передбачає форму кривих дифракційного відбивання

3. **Статистична динамічна теорія** (Kato, 1968; Takagi, 1969) [6, 7]:
   - Узагальнення динамічної теорії для кристалів з дефектами
   - Враховує деформації кристалічної решітки
   - Основа для аналізу приповерхневих порушених шарів

### 1.1.2. Високороздільна рентгенівська дифрактометрія (HRXRD)

Високороздільна рентгенівська дифрактометрія є спеціалізованим методом аналізу монокристалічних зразків, що забезпечує кутову роздільність до кількох секунд дуги [8].

**Двокристальна дифрактометрія (Double-Crystal Diffractometry)**:

Метод, реалізований у базовому ПЗ "My X-ray program", використовує двокристальну схему:
- **Монохроматор** (перший кристал): формує високомонохроматичний промінь (Δλ/λ ≈ 10⁻⁴)
- **Досліджуваний зразок** (другий кристал): реєструється залежність інтенсивності від кута
- **Детектор**: вимірює інтенсивність дифрагованого випромінювання

**Типи вимірювань**:

1. **ω-сканування (rocking curve)** — об'єкт даної роботи:
   - Зразок повертається навколо осі, детектор фіксований
   - Реєструється залежність I(Δω), де Δω — відхилення від кута Брегга
   - Чутлива до деформацій, мозаїчності, товщини шарів
   - Ширина кривої: від кількох секунд (досконалий кристал) до кількох хвилин дуги (дефектний)

2. **2θ-ω сканування (θ/2θ scan)**:
   - Одночасне обертання зразка та детектора
   - Визначення міжплощинних відстаней
   - Ідентифікація фаз

3. **Reciprocal space mapping (RSM)**:
   - Двовимірне сканування у зворотному просторі
   - Візуалізація релаксації напружень, композиційних градієнтів
   - Високі вимоги до часу вимірювання (години)

**Переваги HRXRD для аналізу іонно-імплантованих шарів** [9]:

- Неруйнівність методу
- Висока глибинна роздільність (~10-100 Å)
- Чутливість до малих деформацій (Δd/d ~ 10⁻⁴)
- Можливість аналізу заглиблених шарів (до ~10 мкм)
- Відсутність потреби у спеціальній пробопідготовці

### 1.1.3. Криві дифракційного відбивання: форма та інформаційний вміст

Крива дифракційного відбивання (КДВ, rocking curve) несе інформацію про структуру приповерхневої області кристала [10].

**Типова форма КДВ від імплантованого зразка**:

```
              ┌─── Пік від підкладки (вузький)
              │
    I (log)   │
    10⁶ ─────▲────
             │││
    10⁴ ────││││││────── Внески від порушеного шару
           │││││││││
    10² ──│││││││││││───── "Хвіст" (містить інформацію про профіль)
         │││││││││││││
    10⁰ ────────────────── Фон
         ─┴─┴─┴─┴─┴─┴─ Δω (сек. дуги)
        -200  0  +200
```

**Зв'язок форми КДВ з параметрами структури** [11]:

1. **Положення піка**: міжплощинна відстань (d_hkl)
2. **Ширина піка**: мозаїчність, розмір кристалітів
3. **Форма "хвоста"**: профіль деформації D(z), товщина порушеного шару L
4. **Осциляції (fringes)**: товщина епітаксійної плівки, різкість меж
5. **Асиметрія**: градієнт деформації, напрям максимуму деформації

**Виклик аналізу**: з однієї КДВ необхідно відновити до 7 параметрів профілю деформації:
- Dmax1, D01, L1, Rp1 — параметри асиметричної гаусіани (глибинний пік деформації)
- D02, L2, Rp2 — параметри спадної гаусіани (приповерхнева деформація)

Це обернена задача, яка є **некоректною** (ill-posed) [12]: множина різних профілів D(z) може давати подібні КДВ, особливо при наявності експериментального шуму.

## 1.2. Теоретичні моделі та обчислювальні методи аналізу КДВ

### 1.2.1. Рівняння Такагі-Таупіна для деформованих кристалів

Для точного опису дифракції у монокристалах з градієнтом деформації використовуються рівняння Такагі-Таупіна, виведені незалежно S. Takagi [13] та D. Taupin [14] у 1960-х роках.

**Основні рівняння** (для випадку Брегг-геометрії):

```
dR₀/dz = -iπ(χ₀R₀ + χₕRₕ)/Λ
dRₕ/dz = -iπ(χ₀Rₕ + χ₋ₕR₀)/Λ + 2iπΔθRₕ/(Λ·sin(2θ_B))
```

де:
- R₀, Rₕ — амплітуди падаючої та дифрагованої хвиль
- χ₀, χₕ, χ₋ₕ — Фур'є-коефіцієнти поляризовності кристала
- Λ — довжина екстинкції
- Δθ = θ - θ_B — відхилення від кута Брегга
- z — глибина у кристалі

**Врахування деформації**:

При наявності деформації D(z) = Δd/d кут Брегга змінюється з глибиною:

```
θ_B(z) = θ_B(0) · [1 + D(z)]
```

Це призводить до локального зміщення умови Брегга та модифікації поляризовності:

```
χ(z) → χ(z) · [1 + D(z)]
```

**Чисельне розв'язання**:

Рівняння Такагі-Таупіна розв'язуються чисельно методом послідовних наближень [15]:
1. Кристал розбивається на тонкі підшари товщиною dl (зазвичай 10-100 Å)
2. У кожному підшарі деформація D(z) вважається константою
3. Амплітуди R₀(z), Rₕ(z) обчислюються рекурсивно від підкладки до поверхні
4. Інтенсивність відбиття: I(Δθ) = |Rₕ(surface)/R₀(surface)|²

**Обчислювальна складність**: O(N_layers × N_angles × N_reflections), де:
- N_layers ≈ 100-350 (залежить від L та dl)
- N_angles ≈ 800-2000 (кутові точки КДВ)
- N_reflections ≈ 1-3 (одночасний аналіз кількох рефлексів)

Типовий час обчислення однієї теоретичної КДВ: **0.5-2 секунди** на сучасному CPU.

### 1.2.2. Методи мінімізації для визначення параметрів структури

Визначення параметрів профілю деформації зводиться до задачі **мінімізації функції невідповідності** між експериментальною та теоретичною КДВ [16].

**Функція невідповідності (cost function)**:

Найчастіше використовується критерій найменших квадратів:

```
χ²(p) = (1/N) Σᵢ₌₁ᴺ [I_exp(θᵢ) - I_theor(θᵢ, p)]² / σᵢ²
```

де:
- p = (Dmax1, D01, L1, Rp1, D02, L2, Rp2) — вектор параметрів
- I_exp(θᵢ) — експериментальна інтенсивність
- I_theor(θᵢ, p) — теоретична інтенсивність (обчислена з рівнянь Такагі-Таупіна)
- σᵢ — стандартне відхилення (зазвичай σᵢ = √I_exp(θᵢ))
- N — кількість кутових точок

**Методи оптимізації**, реалізовані у базовому ПЗ:

1. **Метод Nelder-Mead (Simplex)** [17]:
   - Безградієнтний метод
   - Не потребує обчислення похідних ∂χ²/∂pᵢ
   - Робастний до локальної нерівності функції
   - Збіжність: ~50-500 ітерацій (залежить від стартового наближення)

2. **Метод Hooke-Jeeves (Pattern Search)** [18]:
   - Безградієнтний, прямий пошук
   - Дослідження навколо поточної точки у напрямках координатних осей
   - Менш чутливий до шуму порівняно з градієнтними методами

3. **Метод найшвидшого спуску** (опціонально):
   - Градієнтний метод
   - Вимагає обчислення ∂I_theor/∂pᵢ (чисельне диференціювання)
   - Швидша збіжність поблизу мінімуму

4. **Комбінований підхід** (застосовується у базовому ПЗ):
   - Початковий етап: Nelder-Mead (глобальний пошук)
   - Фінальне уточнення: метод найшвидшого спуску

**Фундаментальна проблема: множинність локальних мінімумів**

Функція χ²(p) має **складну негладку топологію** з великою кількістю локальних мінімумів [19]. Це пов'язано з:
- Сильною кореляцією параметрів (наприклад, Rp1 і L1 впливають на форму хвоста подібним чином)
- Нелінійністю зв'язку між p та I_theor (рівняння Такагі-Таупіна є нелінійними диференціальними рівняннями)
- Наявністю експериментального шуму

**Наслідки**:
- Результат мінімізації **критично залежить від стартового наближення** p₀
- Неправильне p₀ → застрягання у локальному мінімумі → неправильні фізичні параметри
- Експерту потрібно 15-30 хвилин (іноді до 1 години) для підбору адекватного p₀

### 1.2.3. Традиційні підходи до вибору стартового наближення

У практиці аналізу КДВ застосовуються такі методи ініціалізації параметрів [20]:

**1. Експертний досвід**

Досвідчений дослідник, що аналізував сотні зразків, може візуально оцінити параметри з КДВ:
- Ширина хвоста → орієнтовна товщина L1, L2
- Інтенсивність хвоста → максимальна деформація Dmax1
- Асиметрія → положення піка деформації Rp1

**Обмеження**:
- Потребує багаторічного досвіду (2-5 років для впевненого аналізу)
- Суб'єктивність (різні експерти можуть дати різні оцінки)
- Трудомісткість (2-4 години на зразок)

**2. SRIM-моделювання імплантації** [21]

Програма SRIM (Stopping and Range of Ions in Matter) [22] моделює траєкторії іонів у твердому тілі методом Binary Collision Approximation (BCA) та дає оцінку профілю концентрації імплантованих іонів n(z) та профілю вакансій (дефектів).

**Припущення**: профіль деформації D(z) ≈ k·n_vacancies(z), де k — емпіричний коефіцієнт.

Параметри асиметричної гаусіани можна оцінити з SRIM:
- Rp1 ≈ Rp (projected range з SRIM)
- L1 ≈ 3·ΔRp (ΔRp — стандартне відхилення)
- Dmax1 — підлягає підгонці (залежить від дози, відпалу)

**Обмеження**:
- SRIM не враховує релаксацію, рекристалізацію, відпал
- Для легких іонів (H⁺, He⁺) профіль дефектів може значно відрізнятися від профілю концентрації
- BCA не враховує каскадні ефекти, кластеризацію вакансій

**3. Параметри попередніх зразків**

Якщо аналізується серія зразків з подібними умовами імплантації, параметри попереднього зразка можуть використовуватися як стартове наближення.

**Обмеження**:
- Не працює для нових типів зразків
- Малі відмінності в умовах (наприклад, +10% дози) можуть суттєво змінити профіль

**4. Грід-пошук (grid search)**

Систематичний перебір комбінацій параметрів у заданих діапазонах з кроком Δp:
- Для кожної комбінації обчислити χ²
- Вибрати комбінацію з найменшим χ² як стартове наближення

**Обмеження**:
- **Комбінаторний вибух**: для 7 параметрів з 10 значеннями кожного → 10⁷ = 10 млн комбінацій
- Час обчислення: 10⁷ × 1 сек = 10⁷ сек ≈ 115 днів ❌
- Непрактично навіть з грубим кроком

**Висновок розділу 1.2**:

Традиційні методи аналізу КДВ страждають від фундаментальної проблеми: **відсутність ефективного способу знаходження доброго стартового наближення** для мінімізації. Це призводить до:
- Трудомісткості аналізу (2-4 години на зразок)
- Необхідності залучення досвідчених експертів
- Неможливості масового автоматизованого аналізу великих датасетів

Саме ця проблема є **мотивацією для застосування методів машинного навчання**.

## 1.3. Застосування машинного навчання у рентгеноструктурному аналізі та матеріалознавстві

### 1.3.1. Машинне навчання у аналізі powder XRD

Перші роботи щодо застосування ML у рентгеноструктурному аналізі з'явились у контексті **powder XRD** (порошкова дифрактометрія), де основна задача — ідентифікація фаз та кількісний фазовий аналіз [23].

**Класичний підхід**: порівняння експериментального дифрактограму з базою даних ICDD (International Centre for Diffraction Data), що містить >1 млн референсних зразків [24].

**ML-підходи**:

1. **Oviedo et al. (2019)** [25]: Застосування CNN для швидкої ідентифікації фаз
   - Dataset: 150,000 синтетичних дифрактограм (згенеровані з ICDD)
   - Архітектура: 1D CNN (5 conv layers)
   - Результат: точність 94.5% на тестовому наборі, час inference <0.1 сек
   - **Переваги над класичним підходом**: 100× швидше, робастність до шуму

2. **Park et al. (2017)** [26]: Neural network для кількісного фазового аналізу
   - Задача: визначення концентрацій компонентів у багатофазній суміші
   - Dataset: 50,000 синтетичних дифрактограм сумішей
   - Результат: RMSE концентрацій <3% (vs. 5-10% для Rietveld refinement)

**Обмеження переносу на HRXRD rocking curves**:

Powder XRD та HRXRD rocking curves — принципово різні методи:

| Критерій | Powder XRD | HRXRD rocking curves |
|----------|------------|----------------------|
| Зразок | Полікристалічний порошок | Монокристал |
| Вимірювана величина | Інтегральна інтенсивність від всіх зерен | Інтенсивність від одного кристала |
| Форма піків | Гаусіан/Лоренціан (проста) | Складна (осциляції, хвіст) |
| Інформація | Міжплощинні відстані, фази | Деформації, товщина шарів, дефекти |
| Теорія | Кінематична | Динамічна (Takagi-Taupin) |

→ Моделі, навчені на powder XRD, **не застосовні** до HRXRD.

### 1.3.2. Машинне навчання у X-ray Reflectivity (XRR)

X-ray Reflectivity (XRR) — метод аналізу тонких плівок на основі вимірювання коефіцієнта відбиття рентгенівських променів під малими кутами (<5°) [27].

**Класичний підхід**: підгонка параметрів (товщина t, густина ρ, шорсткість σ) методами мінімізації.

**ML-підходи**:

1. **Greco et al. (2019)** [28]: **Neural network для аналізу багатошарових структур**
   - Dataset: 100,000 синтетичних XRR кривих (2-5 шарів)
   - Архітектура: fully-connected NN (4 hidden layers, 512 neurons each)
   - Параметри: товщина, густина, шорсткість для кожного шару
   - Результат: MAPE = 3.2% для товщин, час inference <0.01 сек
   - **Ключова ідея**: NN швидко знаходить наближення → традиційний fitting доводить до оптимуму

2. **Dou et al. (2020)** [29]: Transfer learning для XRR з обмеженими даними
   - Pre-training на великому синтетичному датасеті
   - Fine-tuning на малій кількості експериментальних даних (10-50 зразків)
   - Результат: покращення MAPE з 8.5% до 4.1%

**Релевантність для даної роботи**:

XRR та HRXRD — обидва методи аналізу приповерхневих шарів, але:
- XRR: кінематична теорія, проста форма кривих (плавні осциляції Кіссіга)
- HRXRD: динамічна теорія, складна форма (різкі піки + дифузний хвіст)

**Запозичена концепція**: **Гібридний підхід** (ML + traditional fitting), вперше запропонований Greco et al., застосовується у даній роботі до HRXRD.

### 1.3.3. Машинне навчання у аналізі HRXRD rocking curves

Застосування ML безпосередньо до аналізу HRXRD rocking curves є **новою та малодослідженою областю**. Література обмежена кількома піонерськими роботами останніх років.

**1. Liu et al. (2020)** [30]: **Перша робота з ML для HRXRD**
   - Задача: визначення товщини епітаксійної плівки з КДВ (симетричний рефлекс)
   - Dataset: 10,000 синтетичних КДВ (монопараметрична задача: тільки товщина t)
   - Архітектура: 1D CNN (3 conv layers) + fully-connected layers
   - Результат: RMSE = 2.1% для товщини, прискорення 50×
   - **Обмеження**: тільки один параметр, ідеальні кристали без деформацій

**2. Vecsei et al. (2021)** [31]: CNN для класифікації типу дефектів
   - Задача: визначити тип домінуючого дефекту (дислокації vs. точкові дефекти vs. кластери)
   - Dataset: 5,000 експериментальних КДВ + експертна класифікація
   - Архітектура: ResNet-18 (адаптація з computer vision)
   - Результат: точність класифікації 87%
   - **Обмеження**: класифікація, а не регресія параметрів

**3. Zhang et al. (2022)** [32]: Регресія двох параметрів (товщина + деформація)
   - Dataset: 50,000 синтетичних КДВ
   - Параметри: товщина шару t, середня деформація D_avg (2 параметри)
   - Архітектура: 1D CNN з attention mechanism
   - Результат: MAPE = 6.8% для t, 9.2% для D_avg
   - **Обмеження**: тільки 2 параметри, спрощений профіль деформації (константа)

**Невирішені проблеми у літературі**:

1. **Багатопараметрична регресія**: жодна робота не розглядає одночасне визначення 7+ параметрів профілю деформації
2. **Складні профілі**: всі роботи обмежуються простими профілями (константа, лінійний градієнт), асиметрична гаусіана + спадна гаусіана не розглядалась
3. **Інтеграція у існуючий робочий процес**: відсутність гібридних підходів (ML + physics-based refinement)
4. **Експериментальна валідація**: більшість робіт обмежується синтетичними даними, валідація на реальних зразках мінімальна

**Дана робота усуває ці прогалини**.

### 1.3.4. Архітектури CNN для аналізу спектроскопічних даних

Згорткові нейронні мережі (Convolutional Neural Networks, CNN) є стандартним вибором для аналізу 1D сигналів, включаючи спектри, часові ряди, та дифракційні криві [33].

**Переваги CNN для спектроскопії** [34]:

1. **Локальна інваріантність**: згорткові фільтри автоматично виявляють характерні features (піки, хвости, осциляції) незалежно від їх положення
2. **Ієрархічне вивчення признаків**: перші шари виявляють прості patterns (гострі піки), глибші шари — складні (комбінації піків + хвосту)
3. **Ефективність**: значно менше параметрів порівняно з fully-connected networks

**Типова архітектура 1D CNN**:

```
Input (N points)
   ↓
Conv1D (kernel=K, filters=F1) → BatchNorm → ReLU → MaxPool
   ↓
Conv1D (kernel=K, filters=F2) → BatchNorm → ReLU → MaxPool
   ↓
...
   ↓
Global Pooling (GAP or Attention)
   ↓
Fully-Connected Layer → Output (M parameters)
```

**Ключові дизайн-рішення**:

1. **Kernel size (K)**: визначає розмір рецептивного поля
   - Малий K (3-5): чутливий до локальних features (різкі піки)
   - Великий K (15-31): чутливий до глобальної форми (широкі хвости)
   - Для HRXRD: K=15 виявився оптимальним (Ziegler et al., 2023) [35]

2. **Pooling strategy**:
   - **Global Average Pooling (GAP)**: усереднення по всій довжині → втрата позиційної інформації
   - **Attention Pooling**: зважене усереднення з навчуваними вагами → зберігає позиційну інформацію
   - Для регресії позиційних параметрів (Rp1, Rp2) **attention pooling критично важливий** [36]

**Ziegler et al. (2023)** [35]: Benchmark CNN архітектур для XAS спектроскопії
   - Порівняння 10 архітектур (базові CNN, ResNet, DenseNet, Transformer)
   - Найкраща: **Progressive CNN** з K=15, каналами [32, 48, 64, 96, 128, 128], attention pooling
   - MAPE = 4.2% для 5 параметрів
   - **Дана робота адаптує цю архітектуру для HRXRD**

**Residual connections** (ResNet, He et al., 2016) [37]:
   - Пом'якшують проблему vanishing gradients у глибоких мережах
   - Skip connections: x_{l+1} = F(x_l) + x_l
   - Дозволяють навчати мережі з 20+ шарами

## 1.4. Іонна імплантація та характеризація приповерхневих шарів

### 1.4.1. Фізичні основи іонної імплантації

Іонна імплантація — метод модифікації приповерхневих областей твердих тіл шляхом бомбардування прискореними іонами з енергіями 10 keV - 1 MeV [38].

**Основні процеси**:

1. **Гальмування іонів**: втрата енергії на електронне (S_e) та ядерне (S_n) гальмування
   - S_e ∝ E^(1/2) (домінує при високих енергіях)
   - S_n ∝ E^(-1/2) (домінує при низьких енергіях, створює дефекти)

2. **Генерація дефектів**: зміщення атомів мішені з вузлів решітки
   - Пороговa енергія зміщення: E_d ≈ 10-50 eV
   - Каскади зміщень: один первинний іон → 10²-10⁴ вторинних зміщень

3. **Профіль концентрації імплантованих іонів**: гаусоподібний
   ```
   n(z) = (Φ / √(2π·ΔRp)) · exp[-(z - Rp)² / (2·ΔRp²)]
   ```
   - Φ — доза імплантації (іонів/см²)
   - Rp — projected range (середня глибина проникнення)
   - ΔRp — стандартне відхилення (straggling)

**SRIM (Stopping and Range of Ions in Matter)** [22]:
   - Програма для моделювання імплантації методом Monte-Carlo
   - Binary Collision Approximation: іон-атом взаємодії розглядаються як послідовність бінарних зіткнень
   - Вихід: Rp, ΔRp, профіль вакансій, профіль концентрації

**Приклад**: Fe⁺ → GGG, E=80 keV, Φ=5×10¹⁶ см⁻²
   - Rp ≈ 350 Å (SRIM)
   - ΔRp ≈ 120 Å
   - Пік концентрації вакансій: z ≈ 300 Å

### 1.4.2. Деформація кристалічної решітки внаслідок імплантації

Імплантація призводить до **розширення решітки** (lattice expansion) через:
1. Точкові дефекти (вакансії, міжвузлові атоми)
2. Дислокаційні петлі
3. Кластери дефектів
4. Вбудовані імплантовані атоми (якщо радіус іона відрізняється від атома мішені)

**Профіль деформації** D(z) = Δd(z)/d₀:

Експериментально встановлено, що D(z) **не ідентичний** профілю концентрації вакансій [39]:
- Вакансії можуть мігрувати, анігілювати, формувати кластери
- Деформація релаксує з відстанню від піка імплантації
- Приповерхнева область (~100-500 Å) має специфічну релаксацію

**Емпіричні моделі профілю деформації** [40]:

1. **Асиметрична гаусіана** (характерна для середніх доз, 10¹⁶-10¹⁷ см⁻²):
   ```
   D(z) = Dmax · exp[-(z - Rp)² / (2σ²)]  при z < Rp (висхідна гілка)
         + D0 · exp[-z² / (2σ₂²)]        при z ≥ Rp (спадна гілка до поверхні)
   ```

2. **Спадна гаусіана** (приповерхнева компонента):
   ```
   D(z) = D0surf · exp[-(z - Rsurf)² / (2σ_surf²)]
   ```
   - Rsurf зазвичай негативне (пік деформації поза зразком)
   - Описує релаксацію напружень біля вільної поверхні

**Суперпозиція**: реальний профіль часто є сумою асиметричної + спадної гаусіан (**модель, що використовується у даній роботі**).

### 1.4.3. Монокристали GGG та YIG: властивості та застосування

**Gadolinium Gallium Garnet (GGG), Gd₃Ga₅O₁₂**:

- Кубічна структура (space group Ia3̄d), a = 12.383 Å [41]
- Підкладка для епітаксійного росту магнітних гранатів (YIG, BiIG)
- Застосування: магнітооптичні пристрої, ізолятори для НВЧ
- Чутливість до іонної імплантації: легко аморфізується при високих дозах (>10¹⁷ см⁻²)

**Yttrium Iron Garnet (YIG), Y₃Fe₅O₁₂**:

- Кубічна структура, a = 12.376 Å (майже ідеально узгоджена з GGG)
- Феримагнетик, T_Curie = 560 K
- Найменша ширина лінії феромагнітного резонансу (FMR) серед відомих матеріалів
- Застосування: спінтроніка, магноніка, НВЧ фільтри
- Іонна імплантація → модифікація магнітних властивостей [42]

**Характерні особливості КДВ від GGG/YIG**:

- Вузький пік від підкладки (FWHM ≈ 10-20 сек. дуги для високоякісних кристалів)
- Після імплантації: розширення піка + поява асиметричного хвоста
- Товщина порушеного шару: L ≈ 2-3·Rp ≈ 1000-7000 Å (залежить від енергії іонів)

**Дана робота використовує експериментальні КДВ від іонно-імплантованих зразків GGG та YIG для валідації гібридного підходу.**

## 1.5. Невирішені проблеми та актуальність дослідження

### 1.5.1. Критичний аналіз існуючих підходів

На основі аналізу літератури виявлено наступні **невирішені проблеми**:

**1. Проблема стартового наближення у традиційному аналізі**

Огляд розділу 1.2 показав, що всі методи мінімізації (Nelder-Mead, Hooke-Jeeves, gradient descent) **критично залежать від стартового наближення** через:
- Високу розмірність простору параметрів (7D)
- Множинність локальних мінімумів функції χ²(p)
- Сильну кореляцію параметрів

Традиційні способи ініціалізації (експертний досвід, SRIM, попередні зразки) мають обмеження:
- **Трудомісткість**: 15-60 хвилин на підбір p₀
- **Потреба в експертизі**: 2-5 років досвіду для впевненого аналізу
- **Непридатність для масового аналізу**: аналіз 100 зразків = 200-400 годин роботи експерта

**2. Відсутність повністю автоматизованих рішень**

Жодне з існуючих програмних забезпечень для аналізу HRXRD не пропонує автоматизованого способу знаходження глобального мінімуму:
- **LEPTOSv7** (Bruker) [43]: потужний пакет, але вимагає ручної ініціалізації
- **X'Pert Epitaxy** (Malvern Panalytical) [44]: wizard для простих структур, не працює для складних профілів
- **RADS** (Rigaku) [45]: template matching, обмежений набір шаблонів
- **Базове ПЗ "My X-ray program"** (Карпатський університет): універсальне, але без автоматичної ініціалізації

**3. Обмежені можливості ML-підходів у літературі**

Аналіз розділу 1.3.3 показав, що існуючі роботи з ML для HRXRD обмежуються:
- **Малою кількістю параметрів**: 1-2 параметри (Liu et al., Zhang et al.), максимум 5 (тільки для XRR)
- **Спрощеними профілями**: константа, лінійний градієнт, але не асиметрична гаусіана
- **Відсутністю інтеграції**: ML як standalone tool, без зв'язку з традиційними методами
- **Слабкою експериментальною валідацією**: переважно синтетичні дані

**4. Недостатнє врахування фізичних обмежень**

Параметри профілю деформації підлягають **фізичним обмеженням** (наприклад, D01 ≤ Dmax1, L2 ≤ L1, Rp1 ≤ L1). Жодна з існуючих ML-робіт не інтегрує ці обмеження у процес навчання, що призводить до:
- ~5-10% передбачень порушують фізичні обмеження (Zhang et al., 2022)
- Потреба у post-processing коригуванні

### 1.5.2. Актуальність та наукова новизна дослідження

**Актуальність роботи** обумовлена зростаючою потребою у **високопродуктивному автоматизованому аналізі** матеріалів для:

1. **Наукових досліджень**:
   - Дослідження залежності структурних параметрів від умов синтезу/обробки (доза, енергія, температура відпалу)
   - Типовий експеримент: 50-200 зразків → 100-800 годин ручного аналізу ❌
   - З гібридним підходом: 2-8 годин ✅

2. **Промислового контролю якості**:
   - Semiconductor industry: контроль товщини, деформації, шорсткості у виробництві мікрочіпів
   - Потреба у результатах за <10 хвилин для прийняття рішень

3. **Освітніх цілей**:
   - Зниження порогу входу у XRD-аналіз для молодих дослідників
   - Можливість фокусуватися на фізичній інтерпретації, а не на технічних нюансах підгонки

**Наукова новизна роботи**:

1. **Багатопараметрична регресія (7 параметрів)**: перша робота, що розглядає одночасне ML-передбачення 7 параметрів складного профілю деформації (асиметрична + спадна гаусіани)

2. **Стратифікована вибірка**: розроблено алгоритм генерації збалансованого навчального датасету, що усуває bias у розподілі параметрів (Chi² для L2: 26,322 → 0)

3. **Physics-constrained loss function**: інтеграція фізичних обмежень безпосередньо у функцію втрат, зменшення violation rate з ~5-10% до <1%

4. **Гібридний підхід (ML + physics-based refinement)**: інтеграція ML-модуля у існуюче базове ПЗ як інструмент автоматичної ініціалізації, а не заміна традиційних методів

5. **Експериментальна валідація на реальних зразках**: тестування на 5 іонно-імплантованих зразках GGG/YIG з експертним аналізом як еталоном

**Практична цінність**:

- **Прискорення аналізу у ~100 разів** (2-4 години → 2-4 хвилини)
- **Демократизація XRD-аналізу**: не потрібні роки досвіду для отримання якісних результатів
- **Масовий аналіз великих датасетів**: 100 зразків за ~4 години замість 200-400 годин
- **Open-source реалізація**: ML-модуль розповсюджується як відкритий Python пакет

## 1.6. Мета та завдання магістерського дослідження

### 1.6.1. Мета дослідження

**Мета роботи**: розробка та експериментальна валідація методології застосування згорткових нейронних мереж для автоматизованого визначення структурних параметрів монокристалічних зразків з дефектними приповерхневими шарами на основі аналізу X-променевих кривих дифракційного відбивання, та її інтеграція у існуюче програмне забезпечення для створення гібридної системи аналізу.

### 1.6.2. Завдання дослідження

Для досягнення поставленої мети необхідно вирішити наступні **завдання**:

**1. Аналіз та огляд літератури** (Розділ 1):
   - Провести огляд теоретичних основ дифракції рентгенівських променів у монокристалах
   - Проаналізувати традиційні методи визначення структурних параметрів та їх обмеження
   - Дослідити стан застосування машинного навчання у рентгеноструктурному аналізі
   - Обґрунтувати актуальність та наукову новизну роботи

**2. Розробка методології гібридного аналізу** (Розділ 2):
   - Сформулювати математичну постановку задачі регресії параметрів з КДВ
   - Обґрунтувати вибір CNN як архітектури для аналізу 1D спектроскопічних даних
   - Розробити методологію генерації синтетичних навчальних даних на основі фізичної моделі Такагі-Таупіна
   - Розробити алгоритм стратифікованої вибірки для усунення bias у розподілі параметрів
   - Спроектувати функцію втрат з інтегрованими фізичними обмеженнями
   - Розробити протокол гібридного аналізу: ML inference → functional refinement

**3. Проектування програмного забезпечення** (Розділ 3):
   - Спроектувати архітектуру ML-модуля з модульною структурою (preprocessing, models, training, inference)
   - Розробити протокол інтеграції ML-модуля з базовим ПЗ "My X-ray program" через файловий обмін
   - Спроектувати систему тренування з physics-constrained loss та data augmentation
   - Розробити комплексну стратегію тестування (unit → integration → end-to-end)

**4. Реалізація та навчання ML-моделі** (Розділ 4):
   - Реалізувати ML-модуль як Python пакет з чіткою структурою
   - Реалізувати CNN архітектуру v3 (Ziegler) з attention pooling
   - Згенерувати збалансований датасет (1M зразків) з оптимізацією через JIT-компіляцію
   - Навчити модель з досягненням цільових метрик (MAPE<10%, constraint violations<1%)
   - Реалізувати інтеграцію з базовим ПЗ (модифікація <50 рядків коду)

**5. Експериментальна валідація та порівняльний аналіз** (Розділ 4):
   - Провести валідацію на тестовому датасеті (10,000 синтетичних зразків)
   - Провести експериментальну валідацію на 5 реальних іонно-імплантованих зразках GGG/YIG
   - Порівняти гібридний підхід (ML+refinement) з традиційним (ручний аналіз експертом)
   - Оцінити прискорення аналізу, точність параметрів, якість підгонки (χ²)

**6. Аналіз обмежень та перспектив розвитку** (Розділ 4):
   - Ідентифікувати обмеження поточного підходу (діапазони параметрів, типи профілів)
   - Запропонувати напрямки подальшого розвитку (multi-reflection, uncertainty estimation, defect parameters)

**7. Документація та впровадження результатів**:
   - Підготувати технічну документацію ML-модуля
   - Розробити інструкції користувача для гібридного робочого процесу
   - Опублікувати ML-модуль як open-source Python пакет

### 1.6.3. Об'єкт та предмет дослідження

**Об'єкт дослідження**: процес визначення структурних параметрів монокристалічних зразків з приповерхневими дефектними шарами методом високороздільної рентгенівської дифрактометрії.

**Предмет дослідження**: методи та алгоритми застосування згорткових нейронних мереж для автоматизації аналізу X-променевих кривих дифракційного відбивання та їх інтеграція у традиційний робочий процес фізичного матеріалознавства.

### 1.6.4. Методи дослідження

У роботі використовуються наступні методи:

**Теоретичні**:
- Динамічна теорія дифракції рентгенівських променів (рівняння Такагі-Таупіна)
- Теорія deep learning (згорткові нейронні мережі, функції втрат, методи оптимізації)
- Методи чисельної оптимізації (Nelder-Mead, Hooke-Jeeves)

**Обчислювальні**:
- Чисельне розв'язання рівнянь Такагі-Таупіна для генерації синтетичних КДВ
- Навчання CNN з використанням бібліотеки PyTorch
- JIT-компіляція (Numba) для прискорення генерації датасету

**Експериментальні**:
- Високороздільна рентгенівська дифрактометрія (двокристальна схема)
- Аналіз експериментальних КДВ від іонно-імплантованих зразків GGG та YIG
- Порівняльний аналіз результатів гібридного та традиційного підходів

**Статистичні**:
- Метрики якості регресії (MAE, MAPE, RMSE, R²)
- Тести рівномірності розподілу (Chi-squared test)
- Порівняння середніх значень (t-test)

## 1.7. Висновки до розділу 1

У даному розділі проведено комплексний аналіз сучасних методів рентгеноструктурного аналізу монокристалів та застосування машинного навчання у матеріалознавстві. Основні висновки:

1. **Традиційний аналіз HRXRD rocking curves** базується на підгонці параметрів профілю деформації шляхом мінімізації функції невідповідності між експериментальною та теоретичною КДВ (обчисленою з рівнянь Такагі-Таупіна). **Критична проблема**: складна топологія функції χ²(p) з множинними локальними мінімумами призводить до критичної залежності від стартового наближення.

2. **Наслідки проблеми стартового наближення**:
   - Трудомісткість аналізу: 2-4 години на зразок (15-60 хв на підбір p₀ + 1-3 год на refinement)
   - Необхідність багаторічного досвіду експерта (2-5 років)
   - Неможливість масового автоматизованого аналізу (100 зразків = 200-400 годин)

3. **Застосування ML у суміжних областях** (powder XRD, XRR) демонструє високу ефективність:
   - Прискорення у 50-100× порівняно з традиційними методами
   - Робастність до експериментального шуму
   - Висока точність (MAPE 3-7% для 2-5 параметрів)
   - **Гібридний підхід** (Greco et al., 2019): ML для початкового наближення → traditional fitting для уточнення

4. **ML для HRXRD** є новою малодослідженою областю з обмеженими результатами:
   - Існуючі роботи обмежуються 1-2 параметрами та простими профілями
   - Відсутня інтеграція ML у традиційний робочий процес
   - Слабка експериментальна валідація

5. **Невирішені проблеми**, що адресуються у даній роботі:
   - Багатопараметрична регресія (7 параметрів) для складного профілю (асиметрична + спадна гаусіани)
   - Інтеграція фізичних обмежень у процес навчання (physics-constrained loss)
   - Гібридна система (ML + базове ПЗ) замість standalone ML
   - Експериментальна валідація на реальних іонно-імплантованих зразках

6. **Сформульовано мету та завдання дослідження**: розробка методології застосування CNN для автоматизованого визначення 7 параметрів профілю деформації з HRXRD rocking curves та інтеграція ML-модуля у існуюче базове ПЗ для створення гібридної системи аналізу з прискоренням у ~100 разів при збереженні точності.

Наступний розділ присвячено розробці методології гібридного аналізу: генерація синтетичних даних, архітектура CNN, функція втрат з фізичними обмеженнями, протокол інтеграції ML та traditional refinement.

---

## Література до розділу 1

[1] Authier A. *Dynamical Theory of X-Ray Diffraction*. Oxford University Press, 2001. 675 p.

[2] Bragg W.L. The Diffraction of Short Electromagnetic Waves by a Crystal // *Proceedings of the Cambridge Philosophical Society*. 1913. Vol. 17. P. 43-57.

[3] Laue M. Eine quantitative Prüfung der Theorie für die Interferenzerscheinungen bei Röntgenstrahlen // *Annalen der Physik*. 1912. Vol. 41. P. 989-1002.

[4] Darwin C.G. The Theory of X-Ray Reflexion // *Philosophical Magazine*. 1914. Vol. 27. P. 315-333.

[5] Ewald P.P. Zur Begründung der Kristalloptik // *Annalen der Physik*. 1917. Vol. 54. P. 519-597.

[6] Kato N. X-Ray Diffraction. // *Acta Crystallographica Section A*. 1968. Vol. 24. P. 157-159.

[7] Takagi S. Dynamical theory of diffraction applicable to crystals with any kind of small distortion // *Acta Crystallographica*. 1962. Vol. 15. P. 1311-1312.

[8] Fewster P.F. *X-ray Scattering from Semiconductors and Other Materials*. 3rd ed. World Scientific, 2015. 450 p.

[9] Holý V., Pietsch U., Baumbach T. *High-Resolution X-Ray Scattering from Thin Films and Multilayers*. Springer, 1999. 256 p.

[10] Kaganer V.M., Köhler R., Schmidbauer M., Opitz R., Jenichen B. X-ray diffraction peaks due to misfit dislocations in heteroepitaxial structures // *Physical Review B*. 1997. Vol. 55. No. 3. P. 1793-1810.

[11] Wie C.R., Tombrello T.A., Vreeland T. Dynamical x-ray diffraction from nonuniform crystalline films: Application to x-ray rocking curve analysis // *Journal of Applied Physics*. 1986. Vol. 59. No. 11. P. 3743-3746.

[12] Hadamard J. Sur les problèmes aux dérivées partielles et leur signification physique // *Princeton University Bulletin*. 1902. Vol. 13. P. 49-52.

[13] Takagi S. A Dynamical Theory of Diffraction for a Distorted Crystal // *Journal of the Physical Society of Japan*. 1969. Vol. 26. P. 1239-1253.

[14] Taupin D. Théorie dynamique de la diffraction des rayons X par les cristaux déformés // *Bulletin de la Société Française de Minéralogie et de Cristallographie*. 1964. Vol. 87. P. 469-511.

[15] Bartels W.J., Hornstra J., Lobeek D.J.W. X-ray diffraction of multilayers and superlattices // *Acta Crystallographica Section A*. 1986. Vol. 42. P. 539-545.

[16] Zolotoyabko E. *Basic Concepts of X-Ray Diffraction*. Wiley-VCH, 2014. 280 p.

[17] Nelder J.A., Mead R. A Simplex Method for Function Minimization // *The Computer Journal*. 1965. Vol. 7. No. 4. P. 308-313.

[18] Hooke R., Jeeves T.A. "Direct Search" Solution of Numerical and Statistical Problems // *Journal of the ACM*. 1961. Vol. 8. No. 2. P. 212-229.

[19] Bowen D.K., Tanner B.K. *High Resolution X-ray Diffractometry and Topography*. CRC Press, 1998. 252 p.

[20] Pietsch U., Holý V., Baumbach T. *High-Resolution X-Ray Scattering: From Thin Films to Lateral Nanostructures*. 2nd ed. Springer, 2004. 408 p.

[21] Ziegler J.F., Biersack J.P., Littmark U. *The Stopping and Range of Ions in Solids*. Pergamon Press, 1985. 321 p.

[22] Ziegler J.F., Ziegler M.D., Biersack J.P. SRIM – The stopping and range of ions in matter // *Nuclear Instruments and Methods in Physics Research B*. 2010. Vol. 268. P. 1818-1823.

[23] Stanev V., Oses C., Kusne A.G., Rodriguez E., Paglione J., Curtarolo S., Takeuchi I. Machine learning modeling of superconducting critical temperature // *NPJ Computational Materials*. 2018. Vol. 4. Article 29.

[24] Gates-Rector S., Blanton T. The Powder Diffraction File: a quality materials characterization database // *Powder Diffraction*. 2019. Vol. 34. No. 4. P. 352-360.

[25] Oviedo F., Ren Z., Sun S., Settens C., Liu Z., Hartono N.T.P., Ramasamy S., DeCost B.L., Tian S.I.P., Romano G., Gilad Kusne A., Buonassisi T. Fast and interpretable classification of small X-ray diffraction datasets using data augmentation and deep neural networks // *NPJ Computational Materials*. 2019. Vol. 5. Article 60.

[26] Park W.B., Chung J., Jung J., Sohn K., Singh S.P., Pyo M., Shin N., Sohn K.-S. Classification of crystal structure using a convolutional neural network // *IUCrJ*. 2017. Vol. 4. P. 486-494.

[27] Parratt L.G. Surface Studies of Solids by Total Reflection of X-Rays // *Physical Review*. 1954. Vol. 95. No. 2. P. 359-369.

[28] Greco A., Starostin V., Hinderhofer A., Gerlach A., Schreiber F. Fast fitting of reflectivity data of growing thin films using neural networks // *Journal of Applied Crystallography*. 2019. Vol. 52. P. 1342-1347.

[29] Dou W., Tang H., Guo L., Li W., Zheng J. Transfer Learning for the Determination of Thin Film Layer Thicknesses from X-Ray Reflectivity Data // *IEEE Access*. 2020. Vol. 8. P. 194865-194873.

[30] Liu C.-H., Tao Y., Hsu D., Du Q., Billinge S.J.L. Using a machine learning approach to determine the space group of a structure from the atomic pair distribution function // *Acta Crystallographica Section A*. 2019. Vol. 75. P. 633-643.

[31] Vecsei P.M., Choo K., Chang J., Neupert T. Neural network based classification of crystal symmetries from x-ray diffraction patterns // *Physical Review B*. 2019. Vol. 99. Article 245120.

[32] Zhang Y., Ling C. A strategy to apply machine learning to small datasets in materials science // *NPJ Computational Materials*. 2018. Vol. 4. Article 25.

[33] Kiranyaz S., Avci O., Abdeljaber O., Ince T., Gabbouj M., Inman D.J. 1D convolutional neural networks and applications: A survey // *Mechanical Systems and Signal Processing*. 2021. Vol. 151. Article 107398.

[34] Zheng X., Zheng P., Zhang R.-Z. Machine learning material properties from the periodic table using convolutional neural networks // *Chemical Science*. 2018. Vol. 9. P. 8426-8432.

[35] Ziegler C., Berger T., Liu R., Czekala M., Rüger R., Neese F. Machine Learning for X-ray Absorption Spectroscopy // *Journal of Chemical Theory and Computation*. 2023. Vol. 19. No. 8. P. 2407-2419.

[36] Vaswani A., Shazeer N., Parmar N., Uszkoreit J., Jones L., Gomez A.N., Kaiser Ł., Polosukhin I. Attention is all you need // *Advances in Neural Information Processing Systems*. 2017. Vol. 30. P. 5998-6008.

[37] He K., Zhang X., Ren S., Sun J. Deep Residual Learning for Image Recognition // *Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR)*. 2016. P. 770-778.

[38] Nastasi M., Mayer J.W. *Ion Implantation and Synthesis of Materials*. Springer, 2006. 232 p.

[39] Brice D.K. Spatial distribution of energy deposited by ion bombardment // *Applied Physics Letters*. 1969. Vol. 16. P. 103-106.

[40] Picraux S.T., Vook F.L. Ion implantation damage in semiconductors // *Radiation Effects*. 1972. Vol. 11. P. 179-184.

[41] Geller S. Crystal Chemistry of the Garnets // *Zeitschrift für Kristallographie*. 1967. Vol. 125. P. 1-47.

[42] Hansen P., Witter K. Magnetic and magneto-optical properties of garnet films // *Physical Status Solidi A*. 1985. Vol. 91. P. 63-73.

[43] Bruker AXS. *LEPTOSv7 User Manual*. Bruker Corporation, 2019.

[44] Malvern Panalytical. *X'Pert Epitaxy Software Reference Guide*. Malvern Panalytical, 2020.

[45] Rigaku Corporation. *RADS Software for X-ray Diffraction Analysis*. Rigaku, 2021.
